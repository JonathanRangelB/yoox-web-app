<form [formGroup]="mainForm" (ngSubmit)="onSubmit()">
  <p-stepper orientation="vertical" style="max-width: 720px; margin: 0 auto">
    <p-stepperPanel header="Cantidades y plazos">
      <ng-template pTemplate="content" let-index="index">
        <p>Todos los campos son obligatorios</p>
        <div class="grid py-3 pr-2" style="margin-right: 0">
          <!-- inicio de cantidades y plazos -->
          <div class="col-12 sm:col-4 flex flex-column">
            <label for="cantidad">Cantidad a prestar</label>
            <p-inputNumber
              id="cantidad"
              name="cantidad"
              formControlName="cantidad"
              inputId="integeronly"
              placeholder="Cantidad"
              mode="currency"
              currency="MXN"
              locale="es-MX"
              maxFractionDigits="0"
              autofocus="true"
              showClear="true"
              [style]="{ width: '100%' }"
              [inputStyle]="{ width: '100%' }"
              (onInput)="onInputCantidad($event)" />
            <small
              id="cantidad-help"
              class="mb-2 text-red-500"
              [hidden]="esCampoOculto('cantidad')">
              <ng-container
                *ngIf="mainForm.get('cantidad')?.errors?.['required']">
                Cantidad requerida</ng-container
              >
              <ng-container *ngIf="mainForm.get('cantidad')?.errors?.['min']">
                Cantidad minima de 1000</ng-container
              >
            </small>
          </div>
          <div class="col-12 sm:col-4 flex flex-column">
            <label for="tipoCalle">Plazo</label>
            <p-dropdown
              id="plazos"
              name="palzos"
              formControlName="plazos"
              [options]="plazos"
              optionLabel="name"
              (onChange)="onPlazoChanged($event)"
              placeholder="Plazo de semanas"
              [style]="{ width: '100%' }" />
            <small
              id="tipoCalle-help"
              class="mb-2 text-red-500"
              [hidden]="esCampoOculto('plazos')"
              >Selecciona un plazo</small
            >
          </div>
          <div class="col-12 sm:col-4 flex flex-column">
            <label for="fechaInicial">Fecha inicial</label>
            <p-calendar
              id="fechaInicial"
              formControlName="fechaInicial"
              placeholder="dd/mm/aaaa"
              [iconDisplay]="'input'"
              [showIcon]="true"
              [showButtonBar]="true"
              (onSelect)="calculaDiaDeLaSemana($event)"
              dateFormat="dd/mm/yy"
              readonlyInput="true"
              [minDate]="fechaMinima"
              inputId="icondisplay"
              [style]="{ width: '100%' }" />
            <small
              id="fechaInicial-help"
              class="mb-2 text-red-500"
              [hidden]="esCampoOculto('fechaInicial')"
              >Fecha Inicial requerida</small
            >
          </div>

          <!-- inicio valores calculados -->
          <p-inputGroup [style]="{ width: '99%' }">
            <p-inputGroupAddon>
              <i class="pi pi-money-bill"></i>
              <span> Cada semana se pagarian:</span>
            </p-inputGroupAddon>
            <input
              pInputText
              disabled="true"
              placeholder="Cantidad semanal"
              style="color: green; font-weight: bold"
              [value]="pagoSemanal" />
          </p-inputGroup>
          <p-inputGroup [style]="{ width: '99%' }">
            <p-inputGroupAddon>
              <i class="pi pi-percentage"></i>
              <span> Tasa de interes:</span>
            </p-inputGroupAddon>
            <input
              disabled="true"
              pInputText
              placeholder="Tasa de interes"
              [value]="tasaDeInteres" />
          </p-inputGroup>
          <p-inputGroup [style]="{ width: '99%' }">
            <p-inputGroupAddon>
              <i class="pi pi-wallet"></i>
              <span> Total a pagar:</span>
            </p-inputGroupAddon>
            <input
              pInputText
              disabled="true"
              placeholder="Cantidad total a pagar"
              style="color: green; font-weight: bold"
              [value]="totalAPagar" />
          </p-inputGroup>
          <p-inputGroup [style]="{ width: '99%' }">
            <p-inputGroupAddon>
              <i class="pi pi-receipt"></i>
              <span> Pagaria los dias:</span>
            </p-inputGroupAddon>
            <input
              pInputText
              disabled="true"
              placeholder="Dia de la semana que se abona"
              [value]="diaDeLaSemana" />
          </p-inputGroup>
          <p-inputGroup [style]="{ width: '99%' }">
            <p-inputGroupAddon>
              <i class="pi pi-calendar-clock"></i>
              <span> Fecha final estimada:</span>
            </p-inputGroupAddon>
            <input
              type="text"
              pInputText
              placeholder="Fecha final estimada"
              disabled="true"
              [value]="fechaFinal" />
          </p-inputGroup>
          <!-- final de valores calculados -->
        </div>
      </ng-template>
    </p-stepperPanel>
    <!-- fin de Cantidades y plazos -->

    <!-- inicio de Datos del ciente -->
    <p-stepperPanel header="Datos del cliente">
      <ng-template
        pTemplate="content"
        let-prevCallback="prevCallback"
        let-nextCallback="nextCallback"
        let-index="index">
        <div class="grid py-3 pr-2">
          <div class="col-12 sm:col-6 flex flex-column">
            <label for="nombreCliente">Nombre cliente</label>
            <input
              formControlName="nombreCliente"
              pInputText
              id="nombreCliente"
              aria-describedby="nombreCliente-help" />
            <small
              class="mb-2 text-red-500"
              id="nombreCliente-help"
              [hidden]="esCampoOculto('nombreCliente')"
              >Nombre de cliente requerido</small
            >
          </div>

          <div class="col-12 sm:col-6 flex flex-column">
            <label for="apellidoPaternoCliente">Apellido paterno</label>
            <input
              formControlName="apellidoPaternoCliente"
              pInputText
              id="apellidoPaternoCliente"
              aria-describedby="apellidoPaternoCliente-help" />
            <small
              class="mb-2 text-red-500"
              id="apellidoPaternoCliente-help"
              [hidden]="esCampoOculto('apellidoPaternoCliente')"
              >Apellido paterno requerido</small
            >
          </div>
          <div class="col-12 sm:col-6 flex flex-column">
            <label for="apellidoMaternoCliente">Apellido materno</label>
            <input
              formControlName="apellidoMaternoCliente"
              pInputText
              id="apellidoMaternoCliente"
              aria-describedby="apellidoMaternoCliente-help" />
            <small
              id="apellidoMaternoCliente-help"
              class="mb-2 text-red-500"
              [hidden]="esCampoOculto('apellidoMaternoCliente')"
              >Apellido materno requerido</small
            >
          </div>
          <div class="col-12 sm:col-6 flex flex-column">
            <label for="cantidad">Telefono fijo</label>
            <p-inputMask
              formControlName="telefonoFijoCliente"
              mask="999-999-9999"
              unmask="true"
              showClear="true"
              [autoClear]="false"
              placeholder="999-999-9999"
              [style]="{ width: '100%' }" />
            <small
              id="telefonoFijoCliente-help"
              class="mb-2 text-red-500"
              [hidden]="esCampoOculto('telefonoFijoCliente')"
              >Telefono fijo requerido</small
            >
          </div>
          <div class="col-12 sm:col-6 flex flex-column">
            <label for="cantidad">Telefono movil</label>
            <p-inputMask
              formControlName="telefonoMovilCliente"
              mask="999-999-9999"
              unmask="true"
              showClear="true"
              [autoClear]="false"
              placeholder="999-999-9999"
              [style]="{ width: '100%' }" />
            <small
              id="telefonoMovilCliente-help"
              class="mb-2 text-red-500"
              [hidden]="esCampoOculto('telefonoMovilCliente')"
              >Telefono movil Requerido</small
            >
          </div>
          <div class="col-12 sm:col-6 flex flex-column">
            <label for="emailCliente">Correo electronico</label>
            <input
              pInputText
              formControlName="correoCliente"
              id="correoCliente"
              aria-describedby="emailCliente-help" />
            <small
              id="correoCliente-help"
              id="correoCliente-help"
              class="mb-2 text-red-500"
              [hidden]="esCampoOculto('correoCliente')"
              ><ng-container
                *ngIf="mainForm.get('correoCliente')?.errors?.['required']">
                Correo electronico requerido</ng-container
              >
              <ng-container
                *ngIf="mainForm.get('correoCliente')?.errors?.['pattern']">
                Formato de correo invalido</ng-container
              ></small
            >
          </div>
          <div class="col-12 sm:col-6 flex flex-column">
            <label for="ocupacion">Ocupacion</label>
            <input
              pInputText
              id="ocupacion"
              aria-describedby="ocupacion-help" />
            <small id="ocupacion-help">placeholder</small>
          </div>
          <div class="col-12 sm:col-6 flex flex-column">
            <label for="curpCliente">CURP</label>
            <p-inputMask
              mask="aaaa-999999-aaaaaa-99"
              unmask="true"
              showClear="true"
              formControlName="curpCliente"
              placeholder="0000-000000-000000-00"
              styleClass="width: '100%'; 'text-transform': 'uppercase'" />
            <small
              id="curpCliente-help"
              class="mb-2 text-red-500"
              [hidden]="esCampoOculto('curpCliente')"
              ><ng-container
                *ngIf="mainForm.get('curpCliente')?.errors?.['required']">
                CURP requerido</ng-container
              >

              <ng-container
                *ngIf="mainForm.get('curpCliente')?.errors?.['invalidCurp']">
                Formato de CURP invalido</ng-container
              >
            </small>
          </div>
          <div class="col-12 sm:col-6 flex flex-column">
            <label for="tipoCalle">Tipo de calle</label>
            <p-dropdown
              [options]="tiposCalle"
              optionLabel="name"
              [showClear]="true"
              placeholder="Selecciona el tipo de calle"
              [style]="{ width: '100%' }" />
            <small id="tipoCalle-help">placeholder</small>
          </div>
          <div class="col-12 sm:col-6 flex flex-column">
            <label for="nombreCalle">Nombre de la calle</label>
            <input
              pInputText
              id="nombreCalle"
              aria-describedby="nombreCalle-help" />
            <small id="nombreCalle-help">placeholder</small>
          </div>
          <div class="col-12 sm:col-6 flex flex-column">
            <label for="numeroExterior">Numero Exterior</label>
            <input
              pInputText
              id="numeroExterior"
              aria-describedby="numeroExterior-help" />
            <small id="numeroExterior-help">placeholder</small>
          </div>
          <div class="col-12 sm:col-6 flex flex-column">
            <label for="numeroInterior">Numero Interior</label>
            <input
              pInputText
              id="numeroInterior"
              aria-describedby="numeroInterior-help" />
            <small id="numeroInterior-help">placeholder</small>
          </div>
          <div class="col-12 sm:col-6 flex flex-column">
            <label for="colonia">Colonia</label>
            <input pInputText id="colonia" aria-describedby="colonia-help" />
            <small id="colonia-help">placeholder</small>
          </div>
          <div class="col-12 sm:col-6 flex flex-column">
            <label for="municipio">Municipio</label>
            <input
              pInputText
              id="municipio"
              aria-describedby="municipio-help" />
            <small id="municipio-help">placeholder</small>
          </div>
          <div class="col-12 sm:col-6 flex flex-column">
            <label for="estado">Entidad Federativa</label>
            <p-dropdown
              [options]="estadosDeLaRepublica"
              emptyFilterMessage="Sin resultados"
              optionLabel="name"
              [filter]="true"
              filterBy="name"
              [showClear]="true"
              placeholder="Selecciona un estado"
              [style]="{ width: '100%' }">
            </p-dropdown>
            <small id="estado-help">placeholder</small>
          </div>
          <div class="col-12 sm:col-6 flex flex-column">
            <label for="codigoPostal">Código postal</label>
            <p-inputMask
              id="codigoPostal"
              mask="99999"
              placeholder="99999"
              [style]="{ width: '100%' }" />
            <small id="estado-help">placeholder</small>
          </div>
          <div class="col-12 flex flex-column gap-2">
            <label for="codigoPostal">Observaciones adicionales</label>
            <textarea rows="5" cols="30" autoResize="true" pInputTextarea>
            </textarea>
          </div>
        </div>
      </ng-template>
    </p-stepperPanel>
    <!-- final de Datos del ciente -->

    <p-stepperPanel header="Datos de aval">
      <ng-template
        pTemplate="content"
        let-prevCallback="prevCallback"
        let-nextCallback="nextCallback"
        let-index="index">
        <div class="flex flex-column h-12rem">
          <div
            class="border-2 border-dashed surface-border border-round surface-ground flex-auto flex justify-content-center align-items-center font-medium">
            Content III
          </div>
        </div>
        <div class="flex py-4 gap-2">
          <p-button
            label="Back"
            severity="secondary"
            (onClick)="prevCallback.emit()" />
          <p-button label="Next" (onClick)="nextCallback.emit()" />
        </div>
      </ng-template>
    </p-stepperPanel>
    <p-stepperPanel header="Documentacion">
      <ng-template
        pTemplate="content"
        let-prevCallback="prevCallback"
        let-index="index">
        <div class="flex flex-column h-12rem">
          <div
            class="border-2 border-dashed surface-border border-round surface-ground flex-auto flex justify-content-center align-items-center font-medium">
            Content IV
          </div>
        </div>
        <div class="flex py-4 gap-2">
          <p-button
            label="Back"
            severity="secondary"
            (onClick)="prevCallback.emit()" />
          <button pButton type="submit">Enviar solicitud</button>
        </div>
      </ng-template>
    </p-stepperPanel>
  </p-stepper>

  <p-toast
    [breakpoints]="{ '920px': { width: '100%', right: '0', left: '0' } }" />
  <p-confirmDialog
    key="positionDialog"
    [position]="position"
    rejectButtonStyleClass="p-button-outlined" />
</form>
